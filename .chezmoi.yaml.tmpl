{{- /* Checks if running interactively */ -}}
{{- $interactive := stdinIsATTY -}}

{{- /* Template file for chezmoi config file */ -}}
{{- $decrypt_data := false -}}{{- /* true if this machine should decrypt data */ -}}

{{- if hasKey . "decrypt_data" -}}
{{-     $decrypt_data = .decrypt_data -}}
{{- else if $interactive -}}
{{-     $decrypt_data = promptBool "Decrypt data?" -}}
{{- end -}}

{{- $is_kpalatzky := promptBool "Are you kpalatzky? [Yn]" true -}}

{{- if $is_kpalatzky -}}
{{-     $mode := promptString "Template: [H]ome,[w]ork" "h" -}}
{{-     if lower $mode == "h" -}}
{{-         $mode := "home" -}}
{{-     end -}}
{{-     if lower $mode == "w" -}}
{{-         $mode := "work" -}}
{{-     end -}}
{{-     $decrypt_data := true -}}
{{- else -}}
{{-     $mode := "custom" -}}
{{-     $git_user := promptStringOnce . "git_user" "Git User:" -}}
{{-     $git_email := promptStringOnce . "git_email" "Git E-Mail:" -}}

{{-     if $interactive -}}
{{-         writeToStdout "ðŸ’¡ Tip: you can re-enter your data with `chezmoi init --data=false`.\n" -}}
{{-     end -}}
{{- end -}}

{{- if $decrypt_data }}
encryption: age
age:
    identity: {{ .chezmoi.sourceDir }}/key.txt
    recipient: age12xj4kwr50r6rgdtmndlwznd2smeey08hyj85atwakgrl2w7dx3gq809dj3
{{- end }}

data:
    git:
        user: {{ $git_user }}
        email: {{ $git_email }}
    secrets:
        deeplApiKey: {{ $deepl_api_key }}

    decrypt_data: {{ $decrypt_data }}

format: yaml


merge:
    command: nvim

git:
    autoAdd: true