{{- /* Checks if running interactively */ -}}
{{- $interactive := stdinIsATTY -}}

{{- /* Template file for chezmoi config file */ -}}
{{- $agekey := false -}}{{/* true if this machine has agekey to decrypt secret */}}

{{- if hasKey . "agekey" -}}
{{-   $agekey = .agekey -}}
{{- else if $interactive -}}
{{-   $agekey = promptBool "Decrypt data?" -}}
{{- end -}}

{{- if $interactive -}}
{{-   writeToStdout "ðŸ’¡ Tip: you can re-enter your data with `chezmoi init --data=false`.\n" -}}
{{- end -}}

data:
    agekey: {{ $agekey }}

format: yaml

{{- if $agekey }}
encryption: age
age:
    identity: {{ .chezmoi.sourceDir }}/key.txt
    recipient: age12xj4kwr50r6rgdtmndlwznd2smeey08hyj85atwakgrl2w7dx3gq809dj3
{{- end }}

merge:
    command: nvim

git:
    autoAdd: true